<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <title>Formularz SOS</title>
    <style>
        body { font-family: sans-serif; background: #111; color: #fff; padding: 20px; }
        form { max-width: 400px; background: #222; padding: 20px; border-radius: 8px; }
        input, textarea, select, button { 
            width: 100%; display: block; margin-bottom: 15px; padding: 10px; box-sizing: border-box; 
        }
        button { background: #f1ff00; color: #000; font-weight: bold; cursor: pointer; border: none; }
        #status { display: none; padding: 10px; margin-bottom: 10px; border-radius: 4px; }
        #preview { display: none; background: #000; padding: 10px; border-left: 3px solid #f1ff00; }
    </style>
</head>
<body>

    <form id="sos-form" action="https://formsubmit.co/ajax/adrianmikigo@gmail.com" method="POST">
        <input type="hidden" name="_cc" value="adrianmikulewicz@gmail.com">
        <input type="hidden" name="_captcha" value="false">

        <input type="text" name="name" placeholder="Imię" required>
        <input type="tel" name="phone" placeholder="Telefon" required>
        
        <select name="typ_awarii">
            <option value="Hydraulika">Hydraulika</option>
            <option value="Elektryka">Elektryka</option>
            <option value="Inne">Inne</option>
        </select>

        <textarea name="message" id="msg" placeholder="Opis problemu..." required></textarea>
        
        <button type="submit" id="s-btn">WYŚLIJ ZGŁOSZENIE</button>
    </form>

    <div id="status"></div>
    <div id="preview">
        <strong>Wysłano wiadomość o treści:</strong><br>
        <span id="copy"></span>
    </div>

    <script>
        const form = document.getElementById('sos-form');
        const btn = document.getElementById('s-btn');
        const status = document.getElementById('status');
        const preview = document.getElementById('preview');
        const copy = document.getElementById('copy');

        form.addEventListener('submit', async (e) => {
            e.preventDefault();
            const rawMsg = document.getElementById('msg').value;
            
            btn.disabled = true;
            btn.textContent = "Wysyłanie...";

            try {
                const res = await fetch(form.action, {
                    method: 'POST',
                    body: new FormData(form),
                    headers: { 'Accept': 'application/json' }
                });

                if (res.ok) {
                    status.textContent = "Wysłano pomyślnie!";
                    status.style.background = "green";
                    status.style.display = "block";
                    
                    copy.textContent = rawMsg;
                    preview.style.display = "block";
                    
                    form.reset();
                } else {
                    throw new Error();
                }
            } catch (err) {
                status.textContent = "Błąd wysyłki!";
                status.style.background = "red";
                status.style.display = "block";
            } finally {
                btn.disabled = false;
                btn.textContent = "WYŚLIJ ZGŁOSZENIE";
            }
        });
    </script>

</body>
</html>
